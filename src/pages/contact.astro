---
import Layout from "../layouts/Layout.astro";
import CDONavbar from "../components/cdoNavbar";
import Footer from "../components/footer.tsx";
import { getTranslation } from '../utils/translations';
import { getCollection } from 'astro:content';

// Get language from URL parameter or default to English
const lang = Astro.url.searchParams.get('lang') || 'en';
const isLt = lang === 'lt';

// Create translation function with current language
const t = (key) => getTranslation(key, lang);

// Get contact content based on language
const contentEntries = await getCollection('contact');
const contentEntry = isLt 
  ? contentEntries.find(entry => !entry.id.endsWith('.en.md')) 
  : contentEntries.find(entry => entry.id.endsWith('.en.md'));

// Extract needed content
const title = contentEntry?.data.title || t('contact.title');
const subtitle = contentEntry?.data.subtitle || t('contact.subtitle');
const address = contentEntry?.data.address || "123 Data Street, Suite 456, Technology Park, CA 94107";
const email = contentEntry?.data.email || "info@cdoaas.com";
const phone = contentEntry?.data.phone || "(555) 123-4567";
const formTitle = contentEntry?.data.form_title || t('contact.form.title');
const formSubtitle = contentEntry?.data.form_subtitle || t('contact.form.description');
---

<Layout title={`${title} | CDO as a Service`}>
  <main>
    <CDONavbar client:only="react" />
    
    <!-- page header -->
    <div class="relative pt-20 pb-32 flex content-center items-center justify-center min-h-[75vh]">
      <div class="absolute top-0 w-full h-full bg-center bg-cover" style="background-image: url('/img/contact-bg.jpg');">
        <span class="w-full h-full absolute opacity-50 bg-black"></span>
      </div>
      <div class="container relative mx-auto px-4">
        <div class="items-center flex flex-wrap">
          <div class="w-full lg:w-6/12 px-4 ml-auto mr-auto text-center">
            <div class="text-white">
              <h1 class="text-5xl font-semibold" data-i18n="contact.title">{title}</h1>
              <p class="mt-4 text-lg" data-i18n="contact.subtitle">{subtitle}</p>
            </div>
          </div>
        </div>
      </div>
    </div>
    
    <!-- contact form section -->
    <section class="pb-20 bg-gray-100 -mt-24">
      <div class="container mx-auto px-4">
        <div class="flex flex-wrap">
          <div class="w-full lg:w-8/12 px-4 mx-auto">
            <div class="relative flex flex-col min-w-0 break-words w-full mb-6 shadow-lg rounded-lg bg-white">
              <div class="flex-auto p-5 lg:p-10">
                <h4 class="text-2xl font-semibold" data-i18n="contact.form.title">{formTitle}</h4>
                <p class="leading-relaxed mt-1 mb-4 text-gray-600" data-i18n="contact.form.description">
                  {formSubtitle}
                </p>
                <div class="relative w-full mb-3 mt-8">
                  <label class="block uppercase text-gray-700 text-xs font-bold mb-2" for="full-name" data-i18n="contact.form.fullName">
                    {t('contact.form.fullName')}
                  </label>
                  <input type="text" class="border-0 px-3 py-3 placeholder-gray-400 text-gray-700 bg-white rounded text-sm shadow focus:outline-none focus:ring w-full" placeholder={t('contact.form.fullName')} style="transition: all 0.15s ease 0s;" />
                </div>
                <div class="relative w-full mb-3">
                  <label class="block uppercase text-gray-700 text-xs font-bold mb-2" for="company" data-i18n="contact.form.company">
                    {t('contact.form.company')}
                  </label>
                  <input type="text" class="border-0 px-3 py-3 placeholder-gray-400 text-gray-700 bg-white rounded text-sm shadow focus:outline-none focus:ring w-full" placeholder={t('contact.form.company')} style="transition: all 0.15s ease 0s;" />
                </div>
                <div class="relative w-full mb-3">
                  <label class="block uppercase text-gray-700 text-xs font-bold mb-2" for="email" data-i18n="contact.form.email">
                    {t('contact.form.email')}
                  </label>
                  <input type="email" class="border-0 px-3 py-3 placeholder-gray-400 text-gray-700 bg-white rounded text-sm shadow focus:outline-none focus:ring w-full" placeholder={t('contact.form.email')} style="transition: all 0.15s ease 0s;" />
                </div>
                <div class="relative w-full mb-3">
                  <label class="block uppercase text-gray-700 text-xs font-bold mb-2" for="phone" data-i18n="contact.form.phone">
                    {t('contact.form.phone')}
                  </label>
                  <input type="text" class="border-0 px-3 py-3 placeholder-gray-400 text-gray-700 bg-white rounded text-sm shadow focus:outline-none focus:ring w-full" placeholder={t('contact.form.phone')} style="transition: all 0.15s ease 0s;" />
                </div>
                <div class="relative w-full mb-3">
                  <label class="block uppercase text-gray-700 text-xs font-bold mb-2" for="message" data-i18n="contact.form.message">
                    {t('contact.form.message')}
                  </label>
                  <textarea rows="4" cols="80" class="border-0 px-3 py-3 placeholder-gray-400 text-gray-700 bg-white rounded text-sm shadow focus:outline-none focus:ring w-full" placeholder={t('contact.form.message')}></textarea>
                </div>
                <div class="text-center mt-6">
                  <button class="bg-gray-900 text-white active:bg-gray-700 text-sm font-bold uppercase px-6 py-3 rounded shadow hover:shadow-lg outline-none focus:outline-none mr-1 mb-1" type="button" data-i18n="contact.form.send" style="transition: all 0.15s ease 0s;">
                    {t('contact.form.send')}
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>
    
    <!-- contact info section -->
    <section class="relative py-20">
      <div class="container mx-auto px-4">
        <div class="flex flex-wrap items-center">
          <div class="w-full md:w-6/12 px-4 mr-auto ml-auto">
            <div class="text-gray-600 p-3 text-center inline-flex items-center justify-center w-16 h-16 mb-6 shadow-lg rounded-full bg-gray-100">
              <i class="fas fa-map-marker-alt text-xl"></i>
            </div>
            <h3 class="text-3xl mb-2 font-semibold leading-normal" data-i18n="contact.info.title">
              {t('contact.info.title')}
            </h3>
            <p class="text-lg font-light leading-relaxed mt-4 mb-4 text-gray-700" data-i18n="contact.info.description">
              {t('contact.info.description')}
            </p>
            <div class="flex flex-wrap">
              <div class="w-full md:w-6/12 px-4">
                <div class="relative flex flex-col mt-4">
                  <div class="flex">
                    <div class="px-4 py-1">
                      <i class="far fa-envelope text-xl text-gray-500"></i>
                    </div>
                    <div>
                      <h4 class="text-gray-900 text-lg font-bold" data-i18n="contact.info.email">{t('contact.info.email')}</h4>
                      <p class="mb-4 text-gray-600">{email}</p>
                    </div>
                  </div>
                </div>
                <div class="relative flex flex-col min-w-0">
                  <div class="flex">
                    <div class="px-4 py-1">
                      <i class="fas fa-phone text-xl text-gray-500"></i>
                    </div>
                    <div>
                      <h4 class="text-gray-900 text-lg font-bold" data-i18n="contact.info.phone">{t('contact.info.phone')}</h4>
                      <p class="mb-4 text-gray-600">{phone}</p>
                    </div>
                  </div>
                </div>
              </div>
              <div class="w-full md:w-6/12 px-4">
                <div class="relative flex flex-col mt-4">
                  <div class="flex">
                    <div class="px-4 py-1">
                      <i class="fas fa-map-marker-alt text-xl text-gray-500"></i>
                    </div>
                    <div>
                      <h4 class="text-gray-900 text-lg font-bold" data-i18n="contact.info.office">{t('contact.info.office')}</h4>
                      <p class="mb-4 text-gray-600">{address}</p>
                    </div>
                  </div>
                </div>
                <div class="relative flex flex-col min-w-0">
                  <div class="flex">
                    <div class="px-4 py-1">
                      <i class="far fa-clock text-xl text-gray-500"></i>
                    </div>
                    <div>
                      <h4 class="text-gray-900 text-lg font-bold" data-i18n="contact.info.hours">{t('contact.info.hours')}</h4>
                      <p class="mb-4 text-gray-600">{t('contact.info.hoursDetails')}</p>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="w-full md:w-4/12 px-4 mr-auto ml-auto">
            <div class="relative flex flex-col min-w-0 break-words bg-white w-full mb-6 shadow-lg rounded-lg bg-blue-500">
              <img alt="Office Location" class="w-full align-middle rounded-t-lg" src="/img/office-location.jpg">
              <blockquote class="relative p-8 mb-4">
                <svg preserveAspectRatio="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 583 95" class="absolute left-0 w-full block h-95-px -top-94-px">
                  <polygon points="-30,95 583,95 583,65" class="text-blue-500 fill-current"></polygon>
                </svg>
                <h4 class="text-xl font-bold text-white" data-i18n="contact.consultation.title">
                  {t('contact.consultation.title')}
                </h4>
                <p class="text-md font-light mt-2 text-white" data-i18n="contact.consultation.description">
                  {t('contact.consultation.description')}
                </p>
                <button class="mt-4 bg-white text-blue-500 active:bg-blue-100 text-sm font-bold uppercase px-6 py-3 rounded shadow hover:shadow-lg outline-none focus:outline-none mr-1 mb-1" type="button" data-i18n="contact.consultation.book" style="transition: all 0.15s ease 0s;">
                  {t('contact.consultation.book')}
                </button>
              </blockquote>
            </div>
          </div>
        </div>
      </div>
    </section>
    
    <Footer client:only="react" />
  </main>
</Layout> 